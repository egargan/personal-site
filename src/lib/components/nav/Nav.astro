---
import NavElement from "./NavElement.astro";
// import SoundSwitch from "./SoundSwitch.astro";
import ThemeSwitch from "./ThemeSwitch.astro";

const { class: _class } = Astro.props;
---

<header class={_class}>
  <div class="header-column">
    <nav>
      <ul>
        <li>
          <NavElement
            text="Home"
            path="/"
            isCurrentPage={Astro.url.pathname === "/"}
          />
        </li>
        <li>
          <NavElement
            text="Posts"
            path="/posts"
            isCurrentPage={Astro.url.pathname.startsWith("/posts")}
          />
        </li>
      </ul>
    </nav>

    <ul class="control-panel">
      <li>
        <ThemeSwitch />
      </li>
      <!-- <li> -->
      <!--   <SoundSwitch /> -->
      <!-- </li> -->
    </ul>
  </div>
</header>

<script>
  const header = document.querySelector("header");

  const observer = new IntersectionObserver(
    ([element]) => {
      element.target.classList.toggle("stuck", element.intersectionRatio < 1);
    },
    { threshold: [1] },
  );

  observer.observe(header!);
</script>

<style>
  header {
    width: 100%;

    position: sticky;
    top: -1px;

    background-color: color-mix(in oklab, var(--background), transparent 20%);
    backdrop-filter: blur(5px);

    display: flex;
    justify-content: center;

    margin-top: 10px;
    padding-top: 12px;
    padding-bottom: 8px;

    z-index: 5;
  }

  .header-column {
    display: flex;
    align-items: center;
    justify-content: space-between;

    width: 820px;
  }

  ul {
    gap: 30px;
  }

  ul,
  li {
    display: flex;
  }

  li {
    height: min-content;
  }

  .control-panel {
    display: flex;
    gap: 30px;
  }

  @media (min-width: 640px) {
    header {
      margin-top: 25px;
    }

    nav {
      padding-right: 20px;
    }

    ul {
      gap: 40px;
    }
  }
</style>
