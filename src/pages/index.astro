---
import { getCollection } from "astro:content";

import Layout from "$layouts/Main.astro";
import ArrowIcon from "$lib/components/icons/ArrowIcon.astro";
import CopyOnClick from "$lib/components/CopyOnClick.astro";
import InlineLink from "$lib/components/InlineLink.astro";
import BlogListItem from "$lib/components/BlogListItem.astro";

const posts = (await getCollection("blog"))
  .toSorted((a, b) => (a.data.created < b.data.created ? 1 : -1))
  .slice(0, 2);
---

<Layout title="Ed Gargan" description="Personal website and blog">
  <main>
    <section class="greeting">
      <h1 style={{ "--fly-in-delay": "30ms" }} class="fly-in">Hi, I'm Ed ðŸ‘‹</h1>

      <p style={{ "--fly-in-delay": "60ms" }} class="fly-in">
        I'm a software engineer living in London, telling interactive stories
        with the <InlineLink href="https://www.theguardian.com/interactive">
          Guardian's visual journalism team</InlineLink
        >.
      </p>

      <p style={{ "--fly-in-delay": "60ms" }} class="fly-in">
        I've been in web-focused roles in media for a few years now (<InlineLink
          href="https://www.ft.com/">FT</InlineLink
        > before the Guardian), but I've also built tools and services in cybersecurity
        settings in the past (<InlineLink
          href="https://www.withsecure.com/en/home">WithSecure</InlineLink
        >, <InlineLink href="https://www.netcraft.com/">Netcraft</InlineLink>).
      </p>

      <p style={{ "--fly-in-delay": "60ms" }} class="fly-in">
        In my spare time I like to blog about or doodle with web technology
        &mdash; check out
        <InlineLink openInSameTab href="/labs">my posts</InlineLink>!
      </p>

      <p style={{ "--fly-in-delay": "60ms" }} class="fly-in">
        Say hi at <CopyOnClick text="edwgargan@gmail.com" trailer="," />or find
        me on
        <InlineLink href="https://github.com/egargan">GitHub</InlineLink> and
        <InlineLink href="https://www.linkedin.com/in/edward-gargan-7a0016130/">
          LinkedIn</InlineLink
        >.
      </p>
    </section>

    <section class="recent-posts">
      <!-- TODO: why can't we animate the section? -->
      <div style={{ "--fly-in-delay": "90ms" }} class="fly-in">
        <h1>Recent Posts</h1>
        <a class="arrow-link" href="/blog">
          See All
          <ArrowIcon points="right" />
        </a>
      </div>

      <ul>
        {
          posts.map((post, i) => (
          <li
            style={{ "--fly-in-delay": `${30 * (4 + i)}ms` }}}}
            class="fly-in"
          >
            <BlogListItem {post} />
          </li>
          ))
        }
      </ul>
    </section>
  </main>
</Layout>

<style>
  @media (min-width: 820px) {
    main {
      width: 820px;
    }

    :global(body) {
      align-items: center;
    }
  }

  section.greeting h1 {
    margin-bottom: 32px;
    font-weight: 600;
    font-size: 24px;
  }

  section.greeting {
    margin-top: 56px;
    text-size: 20px;
  }

  section.recent-posts h1 {
    font-size: 24px;
  }

  section.recent-posts {
    margin-top: 56px;
    padding-bottom: 80px;
  }

  section.recent-posts > div {
    margin-bottom: 24px;
    display: flex;
    gap: 40px;
  }

  section.recent-posts ul :global(h2) {
    /* Override header size for blog lists */
    font-size: 20px !important;
  }

  a {
    gap: 4px;
    font-weight: 500;

    text-decoration: underline;
    text-decoration-color: var(--blue);
  }

  a.arrow-link {
    display: inline-flex;
    align-items: center;

    color: var(--blue-strong);
    stroke: var(--blue-strong);
    text-decoration: none;
  }
</style>
